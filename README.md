# 协同白板 (Collaborative Whiteboard)

## 项目介绍

这是一个基于现代 Web 技术构建的实时协同白板应用程序。用户可以创建或加入房间，在同一个画布上进行绘制、擦除和添加文本，并实时同步给房间内的其他参与者。

**主要特性:**

*   **房间模式:** 用户通过输入房间号进入独立的白板空间。
*   **实时协作:** 多用户可以在同一块白板上同时操作，所有操作实时同步。
*   **绘画工具:** 支持画笔（自定义颜色和粗细）和橡皮擦。
*   **文本工具:** 支持在白板上添加自定义字体和字号的文本。
*   **主机功能:** 房间创建者或被移交权限的用户成为主机，拥有清空画布和移交主机权限的能力。
*   **用户管理:** 显示房间内当前在线的用户列表，并标识主机和自己。
*   **WebRTC 数据同步:** 利用 WebRTC DataChannel 实现绘图数据的低延迟传输。
*   **WebSocket 信令:** 使用 WebSocket 服务器进行房间管理、用户状态同步和 WebRTC 信令交换。

## 技术要点

*   **前端:**
    *   **Vue.js:** 构建用户界面和管理应用状态。
    *   **HTML5 Canvas API:** 实现白板的绘制功能。
    *   **WebRTC (RTCPeerConnection & RTCDataChannel):** 负责房间内用户之间点对点的数据传输，用于实时同步绘图和文本数据。
    *   **WebSocket:** 与后端进行信令交换（如加入/离开房间、用户列表更新、主机命令、WebRTC SDP/ICE 交换）。
    *   **JavaScript, HTML, CSS:** 构建应用基础。
*   **后端:**
    *   **Python:** 作为 WebSocket 服务器语言。
    *   **`websockets` 库:** 实现 WebSocket 服务器功能。
    *   **`asyncio` 库:** 支持异步处理多个客户端连接和消息。
    *   **信令服务器:** 转发 WebRTC 连接建立所需的 SDP Offer/Answer 和 ICE Candidates。
    *   **房间和用户管理:** 维护房间列表、房间内用户列表以及主机状态。

## 如何使用

### 环境要求

*   Python 3.7+
*   Node.js (推荐 LTS 版本)
*   npm 或 yarn 或 pnpm

### 安装步骤

1.  **克隆仓库:**

    ```bash
    git clone <你的仓库地址>
    cd <你的仓库目录>
    ```
    请将 `<你的仓库地址>` 替换为你的实际 GitHub 仓库地址，`<你的仓库目录>` 替换为克隆后生成的目录名。

2.  **安装后端依赖:**

    ```bash
    pip install websockets
    ```

3.  **安装前端依赖:**

    ```bash
    # 使用 npm
    npm install

    # 或者使用 yarn
    yarn install

    # 或者使用 pnpm
    pnpm install
    ```

### 运行项目

本项目需要同时运行后端 WebSocket 服务器和前端 Vue 应用。

1.  **启动后端服务器:**

    打开一个终端窗口，进入项目根目录，运行 Python 服务器脚本：

    ```bash
    python server.py
    ```
    服务器默认会在 `ws://0.0.0.0:8765` 监听连接。

2.  **启动前端应用:**

    打开另一个终端窗口，进入项目根目录，运行前端开发服务器：

    ```bash
    # 使用 npm
    npm run serve

    # 或者使用 yarn
    yarn serve

    # 或者使用 pnpm
    pnpm dev
    ```
    前端开发服务器通常会在 `http://localhost:8080` 或其他端口启动。具体地址请查看终端输出。

3.  **访问应用:**

    在浏览器中打开前端应用地址（例如 `http://localhost:8080`）。

### 使用说明

1.  在页面顶部的输入框输入一个房间号（任意字符串，例如 `myroom123`）。
2.  点击 "加入房间" 按钮。如果房间不存在，会自动创建；如果房间已存在，你将加入该房间。第一个加入房间的用户将成为主机。
3.  成功加入后，页面会显示已连接以及你的用户 ID 和房间号。
4.  选择工具（画笔、橡皮擦、文本），调整颜色、粗细、字号/字体等参数。
5.  在白板区域点击或拖动鼠标进行操作。你的操作会实时同步给房间内的其他用户。
6.  在 "在线用户" 区域可以看到房间内的其他用户及其连接状态。
7.  如果你是主机，可以看到 "移交主机权限" 区域，可以选择其他用户进行移交。
8.  如果你是主机，可以点击 "清空" 按钮清空整个白板。
9.  点击 "退出房间" 按钮可以离开当前房间。
